<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./src/index.css">
    <title>Dragon Ball Tracker</title>
</head>
<body>
    <div class="main">
        <div class="randar-box">
          <input type="checkbox" checked class="randar-checkbox"> 
          <div class="randar-top"></div>
          <div class="randar-top-body"></div>
          <div class="randar-content">
            <div class="rander-ball"></div>
            <div class="rander-pos"></div>
          </div>
        </div>
    </div>

    <script>

        let Latitude = 0
        let longitude = 0
        // Function to calculate the x and y coordinates
        function convertLatLonToXY(latA, lonA, latB, lonB) {
            // Approximation for converting degrees to meters (assuming a spherical Earth)
            const earthRadius = 6371000; // in meters
            const toRadians = (degrees) => degrees * (Math.PI / 180);

            // Latitude and longitude differences
            const deltaLat = toRadians(latB - latA);
            const deltaLon = toRadians(lonB - lonA);

            // Convert to x and y using a simple equirectangular projection
            const x = Math.round((earthRadius * deltaLon * Math.cos(toRadians(latA))));
            const y = Math.round((earthRadius * deltaLat));

            return { x, y };
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////////////

        const socket = new WebSocket('wss://gcqyfessid.execute-api.us-east-1.amazonaws.com/demo/'); // Replace with your WebSocket URL
        // Event listener for receiving messages from the server
        socket.addEventListener('message', (event) => {
        // Split the string by commas and extract lat and lng
        console.log(event.data)
        const parts = event.data.split(', ');
        const latPart = parts[1].split(':')[1]; // Extract the part after "lat:"
        const lngPart = parts[2].split(':')[1]; // Extract the part after "lng:"

        // Convert to numbers
        Latitude = parseFloat(latPart);
        longitude = parseFloat(lngPart);

                // Example usage
        const pointA = { lat: 52.447795, lon: -1.834834 }; // Los Angeles
        const pointB = { lat: Latitude, lon: longitude }; // Las Vegas

        const relativeCoordinates = convertLatLonToXY(pointA.lat, pointA.lon, pointB.lat, pointB.lon);
        console.log(`Relative X: ${relativeCoordinates.x} meters`);
        console.log(`Relative Y: ${relativeCoordinates.y} meters`);

        let ballElement = document.getElementsByClassName('rander-ball')[0];
        ballElement.style.left = `${relativeCoordinates.x}px`;
        ballElement.style.top = `${-relativeCoordinates.y}px`;

        console.log('Latitude:', Latitude);
        console.log('Longitude:', longitude);
        });


    </script>
</body>
</html>